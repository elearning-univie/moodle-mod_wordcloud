{"version":3,"file":"addwordtowordcloud.min.js","sources":["../src/addwordtowordcloud.js"],"sourcesContent":["import $ from \"jquery\";\nimport ajax from \"core/ajax\";\nimport notification from \"core/notification\";\nimport ModalFactory from \"core/modal_factory\";\nimport {get_string as getString} from 'core/str';\n\nexport const init = (refreshtime, aid, timestamphtml, listview) => {\n    $('#mod-wordcloud-new-word').keypress(function (e) {\n        // filter enter key to auto commit the word\n        if (e.keyCode === 13) {\n            $('#mod-wordcloud-btn').click();\n        }\n    });\n    document.mod_wordcloud_add_word = function () {\n        var word = $('#mod-wordcloud-new-word').val();\n\n        if (!word.trim()) {\n            return;\n        }\n\n        ajax.call([{\n            methodname: 'mod_wordcloud_add_word',\n            args: {aid: aid, word: word, listview: listview},\n            done: function (returnval) {\n                if (!returnval.cloudhtml) {\n                    ModalFactory.create({\n                        type: ModalFactory.types.CANCEL,\n                        title: getString('warning', 'mod_wordcloud'),\n                        body: returnval.warnings[0].message,\n                    }).then(function (modal) {\n                        modal.show();\n                    });\n                } else {\n                    $('#mod-wordcloud-words-box').html(returnval.cloudhtml);\n                    $('#mod-wordcloud-wcount').text(returnval.sumcount);\n                    $('#mod-wordcloud-new-word').val('');\n                    $('#mod-wordcloud-view-menu').prop('disabled', false);\n                }\n            },\n            fail: notification.exception\n        }]);\n    };\n    setInterval(function(){\n        ajax.call([{\n            methodname: 'mod_wordcloud_get_words',\n            args: {aid: aid, timestamphtml: timestamphtml, listview: listview},\n            done: function (returnval) {\n                if (returnval.cloudhtml) {\n                    $('#mod-wordcloud-words-box').html(returnval.cloudhtml);\n                    $('#mod-wordcloud-wcount').text(returnval.sumcount);\n                    timestamphtml = returnval.timestamphtml;\n                }\n            },\n            fail: notification.exception\n        }]);\n    },refreshtime*1000);\n};"],"names":["refreshtime","aid","timestamphtml","listview","keypress","e","keyCode","click","document","mod_wordcloud_add_word","word","val","trim","call","methodname","args","done","returnval","cloudhtml","html","text","sumcount","prop","create","type","ModalFactory","types","CANCEL","title","body","warnings","message","then","modal","show","fail","notification","exception","setInterval"],"mappings":"siBAMoB,CAACA,YAAaC,IAAKC,cAAeC,gCAChD,2BAA2BC,UAAS,SAAUC,GAE1B,KAAdA,EAAEC,6BACA,sBAAsBC,WAGhCC,SAASC,uBAAyB,eAC1BC,MAAO,mBAAE,2BAA2BC,MAEnCD,KAAKE,sBAILC,KAAK,CAAC,CACPC,WAAY,yBACZC,KAAM,CAACd,IAAKA,IAAKS,KAAMA,KAAMP,SAAUA,UACvCa,KAAM,SAAUC,WACPA,UAAUC,+BAST,4BAA4BC,KAAKF,UAAUC,+BAC3C,yBAAyBE,KAAKH,UAAUI,8BACxC,2BAA2BV,IAAI,wBAC/B,4BAA4BW,KAAK,YAAY,2BAXlCC,OAAO,CAChBC,KAAMC,uBAAaC,MAAMC,OACzBC,OAAO,mBAAU,UAAW,iBAC5BC,KAAMZ,UAAUa,SAAS,GAAGC,UAC7BC,MAAK,SAAUC,OACdA,MAAMC,WASlBC,KAAMC,sBAAaC,cAG3BC,aAAY,yBACHzB,KAAK,CAAC,CACPC,WAAY,0BACZC,KAAM,CAACd,IAAKA,IAAKC,cAAeA,cAAeC,SAAUA,UACzDa,KAAM,SAAUC,WACRA,UAAUC,gCACR,4BAA4BC,KAAKF,UAAUC,+BAC3C,yBAAyBE,KAAKH,UAAUI,UAC1CnB,cAAgBe,UAAUf,gBAGlCiC,KAAMC,sBAAaC,eAEb,IAAZrC"}