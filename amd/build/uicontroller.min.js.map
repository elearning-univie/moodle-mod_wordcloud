{"version":3,"file":"uicontroller.min.js","sources":["../src/uicontroller.js"],"sourcesContent":["const mod_wordcloud_set_height = () => {\n    const wb = document.getElementById('mod-wordcloud-div');\n    const divheight = wb.offsetHeight;\n    let newwidth = 0;\n\n    if (divheight < 300) {\n        newwidth = 50;\n    } else if (divheight < 500) {\n        newwidth = 65;\n    } else if (divheight < 700) {\n        newwidth = 80;\n    } else {\n        newwidth = 100;\n    }\n\n    if (window.innerWidth > 900) {\n        if (wb.style.width == '' || newwidth > parseInt(wb.style.width)) {\n            wb.style.width = newwidth + \"%\";\n        }\n    }\n};\n\nconst mod_wordcloud_hex_to_hsl = (color) => {\n    var [r, g, b] = color.replace(/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i, (m, r, g, b) => '#' + r + r + g + g + b + b)\n        .substring(1).match(/.{2}/g).map(x => parseInt(x, 16));\n\n    r /= 255;\n    g /= 255;\n    b /= 255;\n\n    var max = Math.max(r, g, b), min = Math.min(r, g, b);\n    var h, s, l = (max + min) / 2;\n\n    if (max == min) {\n        h = s = 0;\n    } else {\n        var d = (max - min);\n        s = l >= 0.5 ? d / (2 - (max + min)) : d / (max + min);\n        switch (max) {\n            case r: h = ((g - b) / d + 0)*60; break;\n            case g: h = ((b - r) / d + 2)*60; break;\n            case b: h = ((r - g) / d + 4)*60; break;\n        }\n    }\n    return [Math.round(h), Math.round(s*100), Math.round(l*100)];\n};\n\nconst mod_wordcloud_export_listener = () => {\n    var exportmenu = document.getElementById('mod-wordcloud-export-menu');\n    exportmenu.onchange = function() {\n        var selectedval = this.options[this.selectedIndex].value;\n        if (selectedval == 'png') {\n            document.mod_wordcloud_pic();\n        } else {\n            window.open(selectedval, '_blank');\n        }\n        exportmenu.selectedIndex = 0;\n    };\n};\n\nexport const initlistener = () => {\n    mod_wordcloud_export_listener();\n};\n\nexport const init = colors => {\n    const targetnode = document.getElementById('mod-wordcloud-words-box');\n    const config = { childList: true};\n    const callback = (mutationList) => {\n        for (const mutation of mutationList) {\n            if (mutation.type === 'childList') {\n                mod_wordcloud_set_height();\n            }\n        }\n    };\n\n    const observer = new MutationObserver(callback);\n    observer.observe(targetnode, config);\n\n    var stylerules = '';\n    var editCSS = document.createElement('style');\n\n    if (colors.length == 6) {\n        for (let i = colors.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            [colors[i], colors[j]] = [colors[j], colors[i]];\n        }\n\n        for (let i = 1; i <= colors.length; i++) {\n            stylerules += '.path-mod-wordcloud .w' + i + ' {color: #' + colors[i - 1] + ';} \\n';\n        }\n    } else if (colors.length == 1) {\n        var [h, s, l] = mod_wordcloud_hex_to_hsl(colors[0]);\n        var nextstep = 8;\n\n        l = 30;\n\n        for (let i = 1; i < 7; i++) {\n            stylerules += '.path-mod-wordcloud .w' + i + ' {color: hsl(' + h + ', ' + s + '%, ' + l + '%);} \\n';\n            l = l + nextstep;\n            nextstep++;\n        }\n    }\n\n    editCSS.innerHTML = stylerules;\n    document.head.appendChild(editCSS);\n\n    var viewmenu = document.getElementById('mod-wordcloud-view-menu');\n    viewmenu.onchange = function() {\n        window.location.href = this.options[this.selectedIndex].value;\n    };\n\n    mod_wordcloud_export_listener();\n    mod_wordcloud_set_height();\n\n    var element = document.getElementById('mod-wordcloud-div');\n    element.style.visibility = \"visible\";\n};"],"names":["mod_wordcloud_set_height","wb","document","getElementById","divheight","offsetHeight","newwidth","window","innerWidth","style","width","parseInt","mod_wordcloud_export_listener","exportmenu","onchange","selectedval","this","options","selectedIndex","value","mod_wordcloud_pic","open","colors","targetnode","MutationObserver","mutationList","mutation","type","observe","childList","stylerules","editCSS","createElement","length","i","j","Math","floor","random","h","s","l","color","r","g","b","replace","m","substring","match","map","x","max","min","d","round","mod_wordcloud_hex_to_hsl","nextstep","innerHTML","head","appendChild","location","href","visibility"],"mappings":"6KAAMA,yBAA2B,WACvBC,GAAKC,SAASC,eAAe,qBAC7BC,UAAYH,GAAGI,iBACjBC,SAAW,EAGXA,SADAF,UAAY,IACD,GACJA,UAAY,IACR,GACJA,UAAY,IACR,GAEA,IAGXG,OAAOC,WAAa,MACE,IAAlBP,GAAGQ,MAAMC,OAAeJ,SAAWK,SAASV,GAAGQ,MAAMC,UACrDT,GAAGQ,MAAMC,MAAQJ,SAAW,MA8BlCM,8BAAgC,SAC9BC,WAAaX,SAASC,eAAe,6BACzCU,WAAWC,SAAW,eACdC,YAAcC,KAAKC,QAAQD,KAAKE,eAAeC,MAChC,OAAfJ,YACAb,SAASkB,oBAETb,OAAOc,KAAKN,YAAa,UAE7BF,WAAWK,cAAgB,0BAIP,KACxBN,+CAGgBU,eACVC,WAAarB,SAASC,eAAe,2BAU1B,IAAIqB,kBARHC,mBACT,MAAMC,YAAYD,aACG,cAAlBC,SAASC,MACT3B,8BAMH4B,QAAQL,WAVF,CAAEM,WAAW,QAYxBC,WAAa,GACbC,QAAU7B,SAAS8B,cAAc,YAEhB,GAAjBV,OAAOW,OAAa,KACf,IAAIC,EAAIZ,OAAOW,OAAS,EAAGC,EAAI,EAAGA,IAAK,OAClCC,EAAIC,KAAKC,MAAMD,KAAKE,UAAYJ,EAAI,KACzCZ,OAAOY,GAAIZ,OAAOa,IAAM,CAACb,OAAOa,GAAIb,OAAOY,QAG3C,IAAIA,EAAI,EAAGA,GAAKZ,OAAOW,OAAQC,IAChCJ,YAAc,yBAA2BI,EAAI,aAAeZ,OAAOY,EAAI,GAAK,aAE7E,GAAqB,GAAjBZ,OAAOW,OAAa,KACtBM,EAAGC,EAAGC,GArEeC,CAAAA,YACzBC,EAAGC,EAAGC,GAAKH,MAAMI,QAAQ,oCAAoC,CAACC,EAAGJ,EAAGC,EAAGC,IAAM,IAAMF,EAAIA,EAAIC,EAAIA,EAAIC,EAAIA,IACvGG,UAAU,GAAGC,MAAM,SAASC,KAAIC,GAAKxC,SAASwC,EAAG,MAEtDR,GAAK,IACLC,GAAK,IACLC,GAAK,QAGDN,EAAGC,EADHY,IAAMhB,KAAKgB,IAAIT,EAAGC,EAAGC,GAAIQ,IAAMjB,KAAKiB,IAAIV,EAAGC,EAAGC,GACxCJ,GAAKW,IAAMC,KAAO,KAExBD,KAAOC,IACPd,EAAIC,EAAI,MACL,KACCc,EAAKF,IAAMC,WACfb,EAAIC,GAAK,GAAMa,GAAK,GAAKF,IAAMC,MAAQC,GAAKF,IAAMC,KAC1CD,UACCT,EAAGJ,EAAsB,KAAhBK,EAAIC,GAAKS,EAAI,cACtBV,EAAGL,EAAsB,KAAhBM,EAAIF,GAAKW,EAAI,cACtBT,EAAGN,EAAsB,KAAhBI,EAAIC,GAAKU,EAAI,UAG5B,CAAClB,KAAKmB,MAAMhB,GAAIH,KAAKmB,MAAQ,IAAFf,GAAQJ,KAAKmB,MAAQ,IAAFd,KA+CjCe,CAAyBlC,OAAO,IAC5CmC,SAAW,EAEfhB,EAAI,OAEC,IAAIP,EAAI,EAAGA,EAAI,EAAGA,IACnBJ,YAAc,yBAA2BI,EAAI,gBAAkBK,EAAI,KAAOC,EAAI,MAAQC,EAAI,UAC1FA,GAAQgB,SACRA,WAIR1B,QAAQ2B,UAAY5B,WACpB5B,SAASyD,KAAKC,YAAY7B,SAEX7B,SAASC,eAAe,2BAC9BW,SAAW,WAChBP,OAAOsD,SAASC,KAAO9C,KAAKC,QAAQD,KAAKE,eAAeC,OAG5DP,gCACAZ,2BAEcE,SAASC,eAAe,qBAC9BM,MAAMsD,WAAa"}